<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

<h:head>
    <title>Carrito</title>

    <style>
        body { font-family: Arial; background: #f3f3f3; margin: 0; padding: 20px; }
        h1 { text-align: center; margin-bottom: 30px; }
        table {
            width: 90%; margin: auto; border-collapse: collapse;
            background: white; box-shadow: 0 0 10px #ccc;
        }
        th, td { padding: 14px; text-align: center; border-bottom: 1px solid #ddd; vertical-align: middle; }
        th { background: #007bff; color: white; }
        img { width: 80px; height: 80px; border-radius: 10px; object-fit: cover; }
        .btn-eliminar { background: #dc3545; color: white; border: none; padding: 6px 12px; border-radius: 6px; cursor:pointer; }
        .btn-pago { background: #28a745; padding: 12px 20px; border-radius: 6px; border: none; color: white; font-size: 18px; cursor:pointer; }
        .btn-volver { background: #007bff; padding: 10px 18px; border-radius: 6px; border: none; color: white; margin-right: 10px; cursor:pointer; }
        .total-box { width: 90%; margin: 20px auto; text-align: right; font-size: 22px; font-weight: bold; }
        .pago-box { width: 90%; margin: 10px auto; text-align: right; }
        .descripcion { font-size: 14px; color: #555; }
    </style>
</h:head>

<h:body>

    <ui:include src="header.xhtml" />

    <h1>Carrito de Compras</h1>

    <h:form>
        <table>
            <tr>
                <th>Imagen</th>
                <th>Producto</th>
                <th>Descripción</th>
                <th>Precio</th>
                <th>Cantidad</th>
                <th>Subtotal</th>
                <th>Acción</th>
            </tr>

            <ui:repeat value="#{catalogoBean.carrito}" var="p">
                <tr>
                    <td><h:graphicImage value="#{p.imagen}" /></td>
                    <td>#{p.nombre}</td>
                    <td class="descripcion">#{p.descripcion}</td>
                    <td>$#{p.precio}</td>
                    <td>1</td>
                    <td>$#{p.precio}</td>
                    <td>
                        <h:commandButton value="Eliminar"
                                         action="#{catalogoBean.eliminarCarrito(p)}"
                                         styleClass="btn-eliminar"
                                         immediate="true" />
                    </td>
                </tr>
            </ui:repeat>

        </table>

        <div class="total-box">
            Total: <span style="color:#28a745">$#{catalogoBean.total}</span>
        </div>

        <div class="pago-box">
            <button class="btn-volver" onclick="location.href='catalogo.xhtml'" type="button">Seguir Comprando</button>

            <!-- BOTÓN ARREGLADO -->
            <h:commandButton value="Proceder al Pago"
                 action="#{catalogoBean.irAlPago}"
                 styleClass="btn-pago" />

        </div>
    </h:form>

</h:body>
</html>
